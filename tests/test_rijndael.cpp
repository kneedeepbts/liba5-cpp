#include "doctest.h"

#include "spdlog/spdlog.h"

#include "../rijndael.h"

/*
 * Test Data has been pulled from "3GPP TS 35.207 V12.0.0 (2014-10)".
 */

TEST_CASE("Testing the Rojndael class with (3.3) Test Set 1") {
    spdlog::set_level(spdlog::level::info);

    kneedeepbts::crypto::RijndaelKey key{0x46, 0x5b, 0x5c, 0xe8, 0xb1, 0x99, 0xb4, 0x9f, 0xaa, 0x5f, 0x0a, 0x2e, 0xe2, 0x38, 0xa6, 0xbc};
    std::array<uint8_t, 16> input{0xee, 0x36, 0xf7, 0xcf, 0x03, 0x7d, 0x37, 0xd3, 0x69, 0x2f, 0x7f, 0x03, 0x99, 0xe7, 0x94, 0x9a};
    std::array<uint8_t, 16> expected{0x9e, 0x29, 0x80, 0xc5, 0x97, 0x39, 0xda, 0x67, 0xb1, 0x36, 0x35, 0x5e, 0x3c, 0xed, 0xe6, 0xa2};

    kneedeepbts::crypto::Rijndael dut_rijndael = kneedeepbts::crypto::Rijndael(key);
    std::array<uint8_t, 16> output = dut_rijndael.encrypt(input);

    for (int i = 0; i < 16; i++) {
        CHECK(expected[i] == output[i]);
    }
}
